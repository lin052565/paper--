<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>張數管理</title>
    <style>
        :root {
            --apple-blue: #0071e3;
            --apple-gray: #e8e8ed;
            --apple-bg: #f5f5f7;
            --danger: #ff3b30;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--apple-bg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            user-select: none;
        }

        /* 主畫面卡片 */
        .main-card {
            background: white;
            padding: 70px 50px;
            border-radius: 40px;
            box-shadow: 0 15px 45px rgba(0,0,0,0.05);
            text-align: center;
            width: 320px;
            z-index: 1;
        }

        .label { color: #86868b; font-size: 1.2rem; margin-bottom: 15px; }
        .count-display { font-size: 9rem; font-weight: 700; color: #1d1d1f; line-height: 1; }
        .unit { color: #86868b; font-size: 1.5rem; margin-top: 10px; }

        /* 底部入口區域 - 更改張數 */
        .bottom-trigger-zone {
            position: fixed;
            bottom: 40px;
            text-align: center;
            cursor: pointer;
            padding: 15px 40px;
            transition: opacity 0.2s;
        }

        .bottom-trigger-zone:active { opacity: 0.4; }

        .circle-hint {
            width: 10px;
            height: 10px;
            border: 2px solid #d2d2d7;
            border-radius: 50%;
            margin: 0 auto 10px auto;
        }

        .trigger-text {
            color: #d2d2d7;
            font-size: 0.95rem;
            letter-spacing: 2px;
            font-weight: 500;
        }

        /* 底部彈出面板 */
        .bottom-sheet {
            position: fixed;
            bottom: -100%;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 30px 25px 50px 25px;
            border-radius: 40px 40px 0 0;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 -15px 50px rgba(0,0,0,0.15);
            transition: bottom 0.4s cubic-bezier(0.25, 1, 0.5, 1);
            z-index: 101;
        }

        .bottom-sheet.active { bottom: 0; }

        .handle {
            width: 40px; height: 5px; background: #e8e8ed;
            border-radius: 10px; margin: 0 auto 25px auto;
        }

        /* 功能按鈕組 */
        .button-stack { display: flex; flex-direction: column; gap: 15px; }
        .btn-item {
            border: none; border-radius: 20px; padding: 22px;
            font-size: 1.3rem; font-weight: 600; cursor: pointer;
            transition: transform 0.1s;
        }
        .btn-item:active { transform: scale(0.98); }
        
        .btn-consume { background-color: var(--apple-blue); color: white; }
        .btn-gray { background-color: var(--apple-gray); color: #1d1d1f; }

        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.2); backdrop-filter: blur(5px);
            display: none; z-index: 100;
        }

        .empty-stock { color: var(--danger) !important; }
    </style>
</head>
<body>

<div class="main-card">
    <div class="label">剩餘張數</div>
    <div class="count-display" id="mainNum">0</div>
    <div class="unit">張</div>
</div>

<div class="bottom-trigger-zone" onclick="verifyAccess()">
    <div class="circle-hint"></div>
    <div class="trigger-text">更改張數</div>
</div>

<div class="overlay" id="overlay" onclick="closeSheet()"></div>

<div class="bottom-sheet" id="bottomSheet">
    <div class="handle"></div>
    <div class="button-stack">
        <button class="btn-item btn-consume" onclick="stepCount(-1)">消耗 1 張</button>
        <button class="btn-item btn-gray" onclick="stepCount(1)">增加 1 張</button>
        <button class="btn-item btn-gray" onclick="manualInput()">手動輸入張數</button>
    </div>
    <button style="margin-top:25px; background:none; border:none; color:#86868b; cursor:pointer; width:100%; font-size:1rem;" onclick="closeSheet()">收起面板</button>
</div>

<script>
    // --- 密碼已修改為 0812 ---
    const PASSWORD = "jojo0495";
    // ------------------------

    let count = parseInt(localStorage.getItem('finalProCount')) || 0;

    function render() {
        const display = document.getElementById('mainNum');
        display.innerText = count;
        if (count === 0) display.classList.add('empty-stock');
        else display.classList.remove('empty-stock');
        localStorage.setItem('finalProCount', count);
    }

    function verifyAccess() {
        const pass = prompt("請輸入管理密碼：");
        if (pass === PASSWORD) {
            document.getElementById('overlay').style.display = 'block';
            setTimeout(() => { document.getElementById('bottomSheet').classList.add('active'); }, 10);
        } else if (pass !== null) {
            alert("密碼錯誤！");
        }
    }

    function stepCount(delta) {
        if (count + delta < 0) return;
        count += delta;
        render();
    }

    function manualInput() {
        const val = prompt("✅ 驗證成功\n請輸入新的剩餘張數：", count);
        const parsed = parseInt(val);
        if (!isNaN(parsed) && parsed >= 0) {
            count = parsed;
            render();
        }
    }

    function closeSheet() {
        document.getElementById('bottomSheet').classList.remove('active');
        setTimeout(() => { document.getElementById('overlay').style.display = 'none'; }, 400);
    }

    render();
</script>

</body>
</html>